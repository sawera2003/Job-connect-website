<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CV Generator</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">CV Generator</h1>
        <form id="cvForm" onsubmit="return generateCV()">
            <div class="form-group">
                <label for="profileImage">Profile Image:</label>
                <input type="file" id="profileImage" class="form-control" accept="image/*" required>
            </div>
            <div class="form-group">
                <label for="name">Name:</label>
                <input type="text" id="name" class="form-control" placeholder="Enter your name" required>
            </div>
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" class="form-control" placeholder="Enter your email" required>
            </div>
            <div class="form-group">
                <label for="phone">Phone:</label>
                <input type="tel" id="phone" class="form-control" placeholder="Enter your phone number" required>
            </div>
            <div class="form-group">
                <label for="summary">Summary:</label>
                <textarea id="summary" class="form-control" rows="3" placeholder="Enter a brief summary of yourself" required></textarea>
            </div>
            <div id="education-section">
                <label>Education:</label>
                <div class="education-template mb-3">
                    <input type="text" class="form-control mb-2" placeholder="Enter your degree" required>
                    <input type="text" class="form-control mb-2" placeholder="Enter your institution" required>
                    <input type="text" class="form-control mb-2" placeholder="Enter your graduation date (e.g., June 2023)" required>
                </div>
            </div>
            <button type="button" class="btn btn-secondary mb-3" onclick="addMore('education-section', '.education-template')">Add More Education</button>
            <div id="experience-section">
                <label>Work Experience:</label>
                <div class="experience-template mb-3">
                    <input type="text" class="form-control mb-2" placeholder="Enter job title">
                    <input type="text" class="form-control mb-2" placeholder="Enter company">
                    <input type="text" class="form-control mb-2" placeholder="Enter duration (e.g., 2018-2022)">
                </div>
            </div>
            <button type="button" class="btn btn-secondary mb-3" onclick="addMore('experience-section', '.experience-template')">Add More Experience</button>
            <div class="form-group">
                <label for="reference">Reference:</label>
                <textarea id="reference" class="form-control" rows="3" placeholder="Enter a reference (name, position, contact)"></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Generate CV</button>
        </form>
    </div>

    <script>
        function addMore(sectionId, templateSelector) {
            const section = document.getElementById(sectionId);
            const template = document.querySelector(templateSelector).cloneNode(true);
            section.appendChild(template);
        }

        function generateCV() {
            const name = document.getElementById("name").value;
            const email = document.getElementById("email").value;
            const phone = document.getElementById("phone").value;
            const summary = document.getElementById("summary").value;
            const profileImageInput = document.getElementById("profileImage");
            const profileImageURL = URL.createObjectURL(profileImageInput.files[0]);

            const educations = document.querySelectorAll('#education-section .education-template');
            let educationContent = '';
            educations.forEach((education) => {
                const degree = education.querySelector('input[type="text"]').value;
                const institution = education.querySelectorAll('input[type="text"]')[1].value;
                const graduationDate = education.querySelectorAll('input[type="text"]')[2].value;
                educationContent += `${degree}, ${institution}, Graduated: ${graduationDate}; `;
            });

            const experiences = document.querySelectorAll('#experience-section .experience-template');
            let experienceContent = '';
            experiences.forEach((experience) => {
                const jobTitle = experience.querySelector('input[type="text"]').value;
                const company = experience.querySelectorAll('input[type="text"]')[1].value;
                const duration = experience.querySelectorAll('input[type="text"]')[2].value;
                experienceContent += `${jobTitle} at ${company} (${duration}); `;
            });

            const reference = document.getElementById("reference").value;

            // Store CV content in session storage
            const cvData = {
                name,
                email,
                phone,
                summary,
                profileImage: profileImageURL,
                education: educationContent,
                experience: experienceContent,
                reference
            };
            sessionStorage.setItem('cvData', JSON.stringify(cvData));

            // Redirect to CV display page
            window.location.href = "cv.html";
            return false; // Prevent form submission
        }
    </script>
</body>
</html>
